document.addEventListener("DOMContentLoaded", function () {
  const tnxNavItem = document.querySelector(".sp-tnx-nav-item");
  const moreNavWrap = document.querySelector(".sp-more-nav-wrap");
  const moreText = document.querySelector(".sp-more-text");
  const iconElement = document.querySelector(".sp-tnx-nav-item i");
  function toggleActive() {
    moreNavWrap.classList.toggle("active");
  }
  function toggleText() {
    if (moreText.textContent === "more options") {
      moreText.textContent = "close";
    } else {
      moreText.textContent = "more options";
    }
  }
  function toggleIconClass() {
    iconElement.classList.toggle("spi-more");
    iconElement.classList.toggle("spi-close");
  }
  tnxNavItem.addEventListener("click", function (event) {
    event.stopPropagation();
    toggleActive();
    toggleText();
    toggleIconClass();
  });
  document.addEventListener("click", function (event) {
    if (
      !event.target.closest(".sp-tnx-nav-item") &&
      !event.target.closest(".sp-more-nav-wrap")
    ) {
      moreNavWrap.classList.remove("active");
      moreText.textContent = "more options";
      iconElement.classList.remove("spi-close");
      iconElement.classList.add("spi-more");
    }
  });

  const buttons = document.querySelectorAll(".sp-dropdown-btn");
  let activeDropdown = null;

  buttons.forEach((button) => {
    button.addEventListener("click", function (e) {
      e.stopPropagation();

      const dropdownId = button.getAttribute("data-dropdown");
      const dropdown = document.getElementById(dropdownId);
      const dropPosition = button.getAttribute("data-drop-position");
      const offsetTop = parseInt(button.getAttribute("data-offset-top")) || 0;

      if (dropdown.classList.contains("show")) {
        dropdown.classList.remove("show");
        activeDropdown = null;
      } else {
        if (activeDropdown) {
          activeDropdown.classList.remove("show");
        }

        dropdown.style.visibility = "hidden";
        dropdown.style.display = "block";
        const dropdownWidth = dropdown.clientWidth;
        dropdown.style.visibility = "";
        dropdown.style.display = "";

        const buttonRect = button.getBoundingClientRect();
        const dropdownHeight = dropdown.clientHeight;
        let top = buttonRect.bottom + offsetTop;
        let left = buttonRect.left;

        if (dropPosition === "right") {
          left = buttonRect.right - dropdownWidth - 2;
        }

        dropdown.style.top = top + "px";
        dropdown.style.left = left + "px";
        dropdown.classList.add("show");
        activeDropdown = dropdown;
      }
    });
  });

  document.addEventListener("click", function (e) {
    if (!e.target.classList.contains("sp-dropdown")) {
      let isInsideDropdown = false;
      for (const dropdown of document.querySelectorAll(".sp-dropdown")) {
        if (dropdown.contains(e.target)) {
          isInsideDropdown = true;
          break;
        }
      }

      if (!isInsideDropdown) {
        const dropdowns = document.querySelectorAll(".sp-dropdown");
        dropdowns.forEach((dropdown) => {
          dropdown.classList.remove("show");
        });
        activeDropdown = null;
      }
    }
  });

    let elements = document.querySelectorAll(".sp-info-dot");

    elements.forEach(function(element) {
    let colorValue = element.getAttribute("data-color");
    element.style.backgroundColor = colorValue;
    });

});
